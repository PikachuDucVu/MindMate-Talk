# MindMate-Talk - User Flow Document

> **Version**: 1.0 MVP
> **Last Updated**: 2025-01-27

---

## 1. Overview Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                        USER JOURNEY MAP                              │
└─────────────────────────────────────────────────────────────────────┘

    ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
    │  First   │────▶│  Quick   │────▶│   Home   │────▶│  Voice   │
    │  Visit   │     │ Onboard  │     │  Screen  │     │   Chat   │
    └──────────┘     └──────────┘     └──────────┘     └──────────┘
                                            │
                     ┌──────────────────────┼──────────────────────┐
                     │                      │                      │
                     ▼                      ▼                      ▼
              ┌──────────┐          ┌──────────┐          ┌──────────┐
              │   Mood   │          │   Chat   │          │ Profile  │
              │ Check-in │          │ History  │          │ Settings │
              └──────────┘          └──────────┘          └──────────┘
```

---

## 2. Screen Flows

### 2.1 First Time User Flow (Onboarding)

**Mục tiêu: Vào chat trong < 30 giây**

```
┌─────────────────────────────────────────────────────────────────────┐
│ SCREEN 1: Welcome                                                    │
│                                                                      │
│                         🌱                                           │
│                                                                      │
│              "Chào bạn, mình là MindMate"                           │
│                                                                      │
│         Một người bạn sẵn sàng lắng nghe bạn                        │
│              bất cứ lúc nào, về bất cứ điều gì.                     │
│                                                                      │
│                  ┌─────────────────────┐                            │
│                  │    Bắt đầu thôi!    │                            │
│                  └─────────────────────┘                            │
│                                                                      │
│              Đã có tài khoản? Đăng nhập                             │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│ SCREEN 2: Age Selection (Bắt buộc)                                   │
│                                                                      │
│              "Bạn đang học lớp mấy?"                                │
│                                                                      │
│    ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐              │
│    │ Lớp 6-7 │  │ Lớp 8-9 │  │ Lớp 10-11│ │ Lớp 12  │              │
│    └─────────┘  └─────────┘  └─────────┘  └─────────┘              │
│                                                                      │
│    ┌─────────────────────────────────────────────────┐              │
│    │              Tôi đã tốt nghiệp                  │              │
│    └─────────────────────────────────────────────────┘              │
│                                                                      │
│    ℹ️ Mình hỏi để có thể hiểu bạn hơn thôi                          │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│ SCREEN 3: Quick Signup                                               │
│                                                                      │
│              "Tạo tài khoản để lưu lại các cuộc trò chuyện"         │
│                                                                      │
│    ┌─────────────────────────────────────────────────┐              │
│    │  📧 Email                                        │              │
│    └─────────────────────────────────────────────────┘              │
│    ┌─────────────────────────────────────────────────┐              │
│    │  🔒 Mật khẩu                                     │              │
│    └─────────────────────────────────────────────────┘              │
│    ┌─────────────────────────────────────────────────┐              │
│    │  🔒 Xác nhận mật khẩu                            │              │
│    └─────────────────────────────────────────────────┘              │
│                                                                      │
│                  ┌─────────────────────┐                            │
│                  │     Đăng ký         │                            │
│                  └─────────────────────┘                            │
│                                                                      │
│    ☑️ Tôi đồng ý với Điều khoản sử dụng                             │
│                                                                      │
│    ⚠️ MindMate là bạn đồng hành, không thay thế                     │
│       tư vấn y tế chuyên nghiệp                                     │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│ SCREEN 4: Permission Request                                         │
│                                                                      │
│              "Cho phép MindMate sử dụng micro?"                     │
│                                                                      │
│         Để mình có thể nghe và nói chuyện với bạn                   │
│                                                                      │
│                  ┌─────────────────────┐                            │
│                  │    Cho phép         │                            │
│                  └─────────────────────┘                            │
│                                                                      │
│              Tôi muốn chat bằng text thay thế                       │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                        [HOME SCREEN]
```

---

### 2.2 Home Screen

```
┌─────────────────────────────────────────────────────────────────────┐
│ ≡                                                          ⚙️       │
│                                                                      │
│                         Chào, bạn ơi!                               │
│                   Hôm nay bạn thế nào rồi?                          │
│                                                                      │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │                                                               │  │
│  │                    🎙️                                         │  │
│  │                                                               │  │
│  │              Chạm để bắt đầu trò chuyện                       │  │
│  │                                                               │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  ┌─────────────────────┐  ┌─────────────────────┐                   │
│  │  📊 Mood của bạn    │  │  💬 Lịch sử chat    │                   │
│  └─────────────────────┘  └─────────────────────┘                   │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│  │  Cuộc trò chuyện gần đây                                      │  │
│  │                                                               │  │
│  │  📅 Hôm nay, 14:30                                            │  │
│  │  "Mình đang lo lắng về kỳ thi..."                             │  │
│  │                                                               │  │
│  │  📅 Hôm qua, 21:15                                            │  │
│  │  "Hôm nay mình cảm thấy tốt hơn..."                           │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  ┌────────┐              ┌────────┐              ┌────────┐         │
│  │  🏠    │              │  💭    │              │  👤    │         │
│  │ Trang  │              │ Chat   │              │ Cá     │         │
│  │ chủ   │              │        │              │ nhân   │         │
│  └────────┘              └────────┘              └────────┘         │
└─────────────────────────────────────────────────────────────────────┘
```

---

### 2.3 Voice Chat Screen

```
┌─────────────────────────────────────────────────────────────────────┐
│ ←                     Trò chuyện                              ⋮     │
│                                                                      │
│                                                                      │
│                                                                      │
│                         ╭───────────╮                               │
│                         │           │                               │
│                         │    🌱     │                               │
│                         │           │                               │
│                         │ MindMate  │                               │
│                         │           │                               │
│                         ╰───────────╯                               │
│                                                                      │
│                    "Mình đang lắng nghe..."                         │
│                                                                      │
│                    ═══════════════════════                          │
│                    ▂ ▄ ▆ █ ▆ ▄ ▂ ▄ ▆ █ ▆ ▄                          │
│                    (Audio waveform visualization)                    │
│                                                                      │
│                                                                      │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                                                             │    │
│  │  💬 Chuyển sang text                                        │    │
│  │                                                             │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
│                         ┌───────────┐                               │
│                         │           │                               │
│                         │    🎙️     │  ← Nhấn giữ để nói            │
│                         │           │                               │
│                         └───────────┘                               │
│                                                                      │
│              Nhấn giữ để nói  •  Thả ra để gửi                      │
└─────────────────────────────────────────────────────────────────────┘
```

**Voice Chat States:**

```
STATE 1: Idle (Waiting for user)
┌──────────────┐
│     🎙️       │  "Chạm và giữ để nói"
│   (gray)     │
└──────────────┘

STATE 2: Recording (User is speaking)
┌──────────────┐
│     🎙️       │  "Mình đang nghe..."
│   (pulsing   │   + Waveform animation
│    red)      │
└──────────────┘

STATE 3: Processing (Sending to AI)
┌──────────────┐
│     ⏳       │  "Để mình nghĩ..."
│   (loading)  │
└──────────────┘

STATE 4: AI Speaking
┌──────────────┐
│     🔊       │  AI avatar animates
│   (waves)    │  + Audio waveform
└──────────────┘

STATE 5: AI Finished
┌──────────────┐
│     🎙️       │  "Bạn muốn nói thêm gì không?"
│   (ready)    │
└──────────────┘
```

---

### 2.4 Text Chat Mode (Alternative)

```
┌─────────────────────────────────────────────────────────────────────┐
│ ←                     Trò chuyện                         🎙️        │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │ 🌱 Chào bạn! Hôm nay bạn muốn nói về điều gì?              │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
│                    ┌─────────────────────────────────────────────┐  │
│                    │ Mình đang cảm thấy lo lắng về kỳ thi      │  │
│                    │ sắp tới...                                 │  │
│                    └─────────────────────────────────────────────┘  │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │ 🌱 Mình hiểu. Kỳ thi thường mang lại nhiều áp lực.          │    │
│  │    Bạn có thể kể thêm cho mình nghe về kỳ thi này          │    │
│  │    không? Nó quan trọng thế nào với bạn?                   │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
│                                                                      │
│                                                                      │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│  │ Nhập tin nhắn...                              │  📎  │  ➤  │    │
│  ─────────────────────────────────────────────────────────────────  │
└─────────────────────────────────────────────────────────────────────┘
```

---

### 2.5 Mood Check-in Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│ ←                    Mood Check-in                                   │
│                                                                      │
│                                                                      │
│              "Hôm nay bạn cảm thấy thế nào?"                        │
│                                                                      │
│         Chọn 1-3 cảm xúc mô tả đúng nhất trạng thái của bạn         │
│                                                                      │
│                                                                      │
│    ┌──────────────┐  ┌──────────────┐  ┌──────────────┐            │
│    │   😊         │  │   😌         │  │   😐         │            │
│    │   Vui vẻ     │  │   Bình yên   │  │   Ổn thôi    │            │
│    └──────────────┘  └──────────────┘  └──────────────┘            │
│                                                                      │
│    ┌──────────────┐  ┌──────────────┐  ┌──────────────┐            │
│    │   😩         │  │   😰         │  │   😢         │            │
│    │   Mệt mỏi    │  │   Lo lắng    │  │   Buồn       │            │
│    └──────────────┘  └──────────────┘  └──────────────┘            │
│                                                                      │
│    ┌──────────────┐  ┌──────────────┐  ┌──────────────┐            │
│    │   😵‍💫        │  │   🥺         │  │   😶         │            │
│    │   Rối bời    │  │   Cô đơn     │  │   Trống rỗng │            │
│    └──────────────┘  └──────────────┘  └──────────────┘            │
│                                                                      │
│    ┌──────────────┐  ┌──────────────┐                               │
│    │   😤         │  │   🤯         │                               │
│    │   Tức giận   │  │   Quá tải    │                               │
│    └──────────────┘  └──────────────┘                               │
│                                                                      │
│                                                                      │
│    ┌─────────────────────────────────────────────────────────────┐  │
│    │  Thêm ghi chú (tùy chọn)                                    │  │
│    │  _____________________________________________________      │  │
│    └─────────────────────────────────────────────────────────────┘  │
│                                                                      │
│                  ┌─────────────────────┐                            │
│                  │       Lưu           │                            │
│                  └─────────────────────┘                            │
│                                                                      │
│                        Bỏ qua hôm nay                               │
└─────────────────────────────────────────────────────────────────────┘
```

**After saving:**
```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                      │
│                         ✓                                            │
│                                                                      │
│                   Đã lưu mood của bạn!                              │
│                                                                      │
│              Bạn có muốn nói chuyện về điều này không?              │
│                                                                      │
│    ┌─────────────────────┐     ┌─────────────────────┐              │
│    │  Có, mình muốn      │     │  Không, cảm ơn      │              │
│    └─────────────────────┘     └─────────────────────┘              │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

### 2.6 Mood History Screen

```
┌─────────────────────────────────────────────────────────────────────┐
│ ←                    Mood của bạn                                    │
│                                                                      │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │                     Tháng 1, 2025                             │  │
│  │                                                               │  │
│  │  😊 ─────────────────────────●───────────────                 │  │
│  │  😌 ─────────────●───────────────────────────                 │  │
│  │  😐 ─────●───────────────────────────────────                 │  │
│  │  😢 ───────────────────●─────────────────────                 │  │
│  │  😰 ────────────────────────────●────────────                 │  │
│  │     ─────────────────────────────────────────                 │  │
│  │     1   5   10  15  20  25  30                                │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                      │
│  📅 Hôm nay - 27/01                                                  │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  😰 Lo lắng  •  😩 Mệt mỏi                                    │  │
│  │  "Sắp thi học kỳ, nhiều bài quá"                              │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  📅 Hôm qua - 26/01                                                  │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  😌 Bình yên                                                  │  │
│  │  Không có ghi chú                                             │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  📅 25/01                                                            │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  😊 Vui vẻ  •  😌 Bình yên                                    │  │
│  │  "Đi chơi với bạn bè"                                         │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

### 2.7 Chat History Screen

```
┌─────────────────────────────────────────────────────────────────────┐
│ ←                   Lịch sử trò chuyện                              │
│                                                                      │
│  🔍 Tìm kiếm...                                                      │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                      │
│  📅 Hôm nay                                                          │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  14:30 • 15 phút                                              │  │
│  │  "Lo lắng về kỳ thi học kỳ..."                                │  │
│  │  🏷️ Học tập  •  Stress                                        │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  📅 Hôm qua                                                          │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  21:15 • 8 phút                                               │  │
│  │  "Mình cảm thấy tốt hơn rồi..."                               │  │
│  │  🏷️ Cập nhật                                                  │  │
│  └───────────────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  19:00 • 22 phút                                              │  │
│  │  "Có chuyện với bạn thân..."                                  │  │
│  │  🏷️ Bạn bè  •  Xung đột                                       │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  📅 23/01                                                            │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  20:45 • 12 phút                                              │  │
│  │  "Bố mẹ lại cãi nhau..."                                      │  │
│  │  🏷️ Gia đình                                                  │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

### 2.8 Profile/Settings Screen

```
┌─────────────────────────────────────────────────────────────────────┐
│ ←                      Cài đặt                                       │
│                                                                      │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  👤  Thông tin cá nhân                                        │  │
│  │      user@email.com                                           │  │
│  │      Lớp 10-11                                                │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│  │  🔔  Nhắc nhở check-in mood                              🔘   │  │
│  ─────────────────────────────────────────────────────────────────  │
│  │  🕐  Thời gian nhắc nhở                              20:00    │  │
│  ─────────────────────────────────────────────────────────────────  │
│  │  🎙️  Chế độ mặc định                                Voice    │  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│  │  🔒  Đổi mật khẩu                                         →   │  │
│  ─────────────────────────────────────────────────────────────────  │
│  │  📥  Xuất dữ liệu của tôi                                 →   │  │
│  ─────────────────────────────────────────────────────────────────  │
│  │  🗑️  Xóa tất cả dữ liệu                                   →   │  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│  │  📋  Điều khoản sử dụng                                   →   │  │
│  ─────────────────────────────────────────────────────────────────  │
│  │  🔐  Chính sách bảo mật                                   →   │  │
│  ─────────────────────────────────────────────────────────────────  │
│  │  📞  Hotline hỗ trợ tâm lý                                →   │  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                      │
│  ─────────────────────────────────────────────────────────────────  │
│  │  🚪  Đăng xuất                                                │  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                      │
│                         Version 1.0.0                                │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. Special Flows

### 3.1 Crisis Detection Flow

Xem chi tiết tại [CRISIS-PROTOCOL.md](./CRISIS-PROTOCOL.md)

```
┌─────────────────────────────────────────────────────────────────────┐
│                      CRISIS DETECTION FLOW                           │
└─────────────────────────────────────────────────────────────────────┘

    User says concerning content
              │
              ▼
    ┌─────────────────────┐
    │  AI detects risk    │
    │  keywords/patterns  │
    └─────────────────────┘
              │
              ▼
    ┌─────────────────────┐
    │  Risk Level?        │
    └─────────────────────┘
         │         │
    LOW-MED    HIGH/CRITICAL
         │         │
         ▼         ▼
    Continue    De-escalation
    with care   Protocol
                   │
                   ▼
              Keep talking
              until calmer
                   │
                   ▼
              Gently offer
              hotline info
```

---

### 3.2 Return User Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                       RETURN USER FLOW                               │
└─────────────────────────────────────────────────────────────────────┘

    User opens app
          │
          ▼
    ┌─────────────────┐      ┌─────────────────┐
    │ Has session?    │──No──│  Login Screen   │
    └─────────────────┘      └─────────────────┘
          │ Yes                      │
          ▼                          │
    ┌─────────────────┐              │
    │   Home Screen   │◄─────────────┘
    └─────────────────┘
          │
          ▼
    ┌─────────────────────────────────────────┐
    │  Check: Đã check-in mood hôm nay chưa?  │
    └─────────────────────────────────────────┘
          │              │
         No             Yes
          │              │
          ▼              ▼
    Show gentle      Show home
    mood reminder    normally
    (non-intrusive)
```

---

## 4. Navigation Structure

```
┌─────────────────────────────────────────────────────────────────────┐
│                        APP NAVIGATION                                │
└─────────────────────────────────────────────────────────────────────┘

Bottom Tab Navigation:
┌────────────────┬────────────────┬────────────────┐
│     🏠         │      💭        │      👤        │
│   Trang chủ   │     Chat       │    Cá nhân    │
└────────────────┴────────────────┴────────────────┘

Screen Hierarchy:

🏠 Trang chủ (Home)
├── Voice Chat
│   └── Text Chat (toggle)
├── Mood Check-in
│   └── Mood History
└── Chat History
    └── Chat Detail

💭 Chat (Quick access to chat)
└── Voice Chat / Text Chat

👤 Cá nhân (Profile)
├── Edit Profile
├── Change Password
├── Export Data
├── Delete Data
├── Terms of Service
├── Privacy Policy
├── Hotline Info
└── Logout
```

---

## 5. Error States & Edge Cases

### 5.1 No Internet Connection
```
┌───────────────────────────────────────┐
│                                       │
│              📡                       │
│                                       │
│    Không có kết nối internet          │
│                                       │
│    Mình cần internet để nói chuyện    │
│    với bạn. Hãy thử lại sau nhé!      │
│                                       │
│         ┌──────────────────┐          │
│         │    Thử lại       │          │
│         └──────────────────┘          │
│                                       │
└───────────────────────────────────────┘
```

### 5.2 Microphone Permission Denied
```
┌───────────────────────────────────────┐
│                                       │
│              🎙️ ❌                    │
│                                       │
│    Mình cần quyền microphone          │
│    để nghe bạn nói                    │
│                                       │
│         ┌──────────────────┐          │
│         │  Mở cài đặt      │          │
│         └──────────────────┘          │
│                                       │
│    Hoặc chat bằng text thay thế       │
│                                       │
└───────────────────────────────────────┘
```

### 5.3 AI Response Error
```
┌───────────────────────────────────────┐
│                                       │
│              😅                       │
│                                       │
│    Mình gặp trục trặc rồi             │
│                                       │
│    Bạn thử nói lại được không?        │
│                                       │
│         ┌──────────────────┐          │
│         │    Thử lại       │          │
│         └──────────────────┘          │
│                                       │
└───────────────────────────────────────┘
```
